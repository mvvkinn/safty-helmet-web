<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </head>

  <body>
    <h1 id="helmet_id_title">Request Sample</h1>

    <div class="container">
      <div class="col-md-6">
        <p id="get_output">awaiting output</p>
        <p id="result"></p>
      </div>
      <div class="row">
        <div class="col-md-6">
          <canvas id="userChart1"></canvas>
        </div>
        <div class="col-md-6">
          <canvas id="userChart2"></canvas>
        </div>
      </div>
    </div>
    <script>
      $(document).ready(function () {
        //let timeoutld;
        //let graph;
        getChart();
        function getChart() {
          if (typeof graph !== "undefined") graph.destroy();
        }

        $.ajax({
          url: "/getChartData",
          dataType: "json",
          type: "GET",
          success: function (result) {
            if (result) {
              $("#get_output").html("Data Loaded");
              $("#result").html(
                "humid : " +
                  result.humid +
                  " temp : " +
                  result.temp +
                  " latitude : " +
                  result.latitude +
                  " longitude : " +
                  result.longitude
              );
              $("#helmet_id_title").html("유저 : " + result.helmet_id);
              let userChart1 = document
                .getElementById("userChart1")
                .getContext("2d");

              let barchart1 = new Chart(userChart1, {
                type: "line",
                data: {
                  labels: ["거리", "습도", "온도", "밝기"],
                  datasets: [
                    {
                      label: result.helmet_id,
                      data: [
                        result.distance,
                        result.humid,
                        result.temp,
                        result.photoresistor,
                      ],
                      backgroundColor: [
                        "red",
                        "blue",
                        "rgba(240, 192, 0, 0.5)",
                        "skyblue",
                      ],
                      borderWidth: 5,
                    },
                  ],
                },
              });
            }
          },
        });
      });
      //let userChart1 = document.getElementById("userChart1").getContext('2d');
      let userChart2 = document.getElementById("userChart2").getContext("2d");
    </script>
  </body>
</html>
